<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Phylogenetic Generalized Linear Mixed Model for Comparative Data — pglmm_compare • phyr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Phylogenetic Generalized Linear Mixed Model for Comparative Data — pglmm_compare" />
<meta property="og:description" content="pglmm_compare performs linear regression for Gaussian, binomial and Poisson
phylogenetic data, estimating regression coefficients with approximate standard
errors. It simultaneously estimates the strength of phylogenetic signal in the
residuals and gives an approximate conditional likelihood ratio test for the
hypothesis that there is no signal. Therefore, when applied without
predictor (independent) variables, it gives a test for phylogenetic signal.
pglmm_compare is a wrapper for pglmm tailored for comparative data in
which each value of the response (dependent) variable corresponds to a single tip
on a phylogenetic tree. If there are multiple measures for each species, pglmm
will be helpful." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/benchmarks.html">Performance benchmark</a>
    </li>
    <li>
      <a href="../articles/pglmm.html">Usage of pglmm()</a>
    </li>
    <li>
      <a href="../articles/phyr_example_empirical.html">pglmm example with empirical data</a>
    </li>
    <li>
      <a href="../articles/plot-re.html">Plot random terms of communityPGLMM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/daijiang/phyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Phylogenetic Generalized Linear Mixed Model for Comparative Data</h1>
    <small class="dont-index">Source: <a href='https://github.com/daijiang/phyr/blob/master/R/pglmm_compare.R'><code>R/pglmm_compare.R</code></a></small>
    <div class="hidden name"><code>pglmm_compare.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>pglmm_compare</code> performs linear regression for Gaussian, binomial and Poisson
phylogenetic data, estimating regression coefficients with approximate standard
errors. It simultaneously estimates the strength of phylogenetic signal in the
residuals and gives an approximate conditional likelihood ratio test for the
hypothesis that there is no signal. Therefore, when applied without
predictor (independent) variables, it gives a test for phylogenetic signal.
<code>pglmm_compare</code> is a wrapper for <code>pglmm</code> tailored for comparative data in
which each value of the response (dependent) variable corresponds to a single tip
on a phylogenetic tree. If there are multiple measures for each species, <code>pglmm</code>
will be helpful.</p>
    </div>

    <pre class="usage"><span class='fu'>pglmm_compare</span><span class='op'>(</span>
  <span class='va'>formula</span>,
  family <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  <span class='va'>phy</span>,
  REML <span class='op'>=</span> <span class='cn'>TRUE</span>,
  optimizer <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"nelder-mead-nlopt"</span>, <span class='st'>"bobyqa"</span>, <span class='st'>"Nelder-Mead"</span>, <span class='st'>"subplex"</span><span class='op'>)</span>,
  add.obs.re <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  cpp <span class='op'>=</span> <span class='cn'>TRUE</span>,
  bayes <span class='op'>=</span> <span class='cn'>FALSE</span>,
  reltol <span class='op'>=</span> <span class='fl'>10</span><span class='op'>^</span><span class='op'>-</span><span class='fl'>6</span>,
  maxit <span class='op'>=</span> <span class='fl'>500</span>,
  tol.pql <span class='op'>=</span> <span class='fl'>10</span><span class='op'>^</span><span class='op'>-</span><span class='fl'>6</span>,
  maxit.pql <span class='op'>=</span> <span class='fl'>200</span>,
  marginal.summ <span class='op'>=</span> <span class='st'>"mean"</span>,
  calc.DIC <span class='op'>=</span> <span class='cn'>FALSE</span>,
  prior <span class='op'>=</span> <span class='st'>"inla.default"</span>,
  prior_alpha <span class='op'>=</span> <span class='fl'>0.1</span>,
  prior_mu <span class='op'>=</span> <span class='fl'>1</span>,
  ML.init <span class='op'>=</span> <span class='cn'>FALSE</span>,
  s2.init <span class='op'>=</span> <span class='fl'>1</span>,
  B.init <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>A two-sided linear formula object describing the
fixed-effects of the model; for example, Y ~ X. Binomial data can be either
presence/absence, or a two-column array of 'successes' and 'failures'.
For both binomial and Poisson data, we add an observation-level
random term by default via <code>add.obs.re = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Either "gaussian" for a Linear Mixed Model, or
"binomial" or "poisson" for Generalized Linear Mixed Models.
<code>family</code> should be specified as a character string (i.e., quoted). For binomial and
Poisson data, we use the canonical logit and log link functions, respectively.
Binomial data can be either presence/absence, or a two-column array of 'successes' and 'failures'.
For both Poisson and binomial data, we add an observation-level
random term by default via <code>add.obs.re = TRUE</code>. If <code>bayes = TRUE</code> there are
two additional families available: "zeroinflated.binomial", and "zeroinflated.poisson",
which add a zero inflation parameter; this parameter gives the probability that the response is
a zero. The rest of the parameters of the model then reflect the "non-zero" part
of the model. Note that "zeroinflated.binomial" only makes sense for success/failure
response data.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame containing the variables named in formula. It must has
the tip labels of the phylogeny as row names; if they are not in the same order,
the data frame will be arranged so that row names match the order of tip labels.</p></td>
    </tr>
    <tr>
      <th>phy</th>
      <td><p>A phylogenetic tree as an object of class "phylo".</p></td>
    </tr>
    <tr>
      <th>REML</th>
      <td><p>Whether REML or ML is used for model fitting the random effects. Ignored if
<code>bayes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>optimizer</th>
      <td><p>nelder-mead-nlopt (default), bobyqa, Nelder-Mead, or subplex.
Nelder-Mead is from the stats package and the other optimizers are from the nloptr package.
Ignored if <code>bayes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>add.obs.re</th>
      <td><p>Whether to add observation-level random term for binomial and  Poisson
families. Normally it would be a good idea to add this to account for overdispersion,
so <code>add.obs.re = TRUE</code> by default.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, the model deviance and running
estimates of <code>s2</code> and <code>B</code> are plotted each iteration
during optimization.</p></td>
    </tr>
    <tr>
      <th>cpp</th>
      <td><p>Whether to use C++ function for optim. Default is TRUE. Ignored if <code>bayes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>bayes</th>
      <td><p>Whether to fit a Bayesian version of the PGLMM using <code>r-inla</code>. We recommend
against Bayesian fitting for non-Gaussian data unless sample sizes are large (&gt;1000), because
the phylogenetic variance tends to get trapped near zero.</p></td>
    </tr>
    <tr>
      <th>reltol</th>
      <td><p>A control parameter dictating the relative tolerance
for convergence in the optimization; see <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>.</p></td>
    </tr>
    <tr>
      <th>maxit</th>
      <td><p>A control parameter dictating the maximum number of
iterations in the optimization; see <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>.</p></td>
    </tr>
    <tr>
      <th>tol.pql</th>
      <td><p>A control parameter dictating the tolerance for
convergence in the PQL estimates of the mean components of the
GLMM. Ignored if <code>family = "gaussian"</code> or <code>bayes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>maxit.pql</th>
      <td><p>A control parameter dictating the maximum number
of iterations in the PQL estimates of the mean components of the
GLMM. Ignored if <code>family = "gaussian"</code> or <code>bayes = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>marginal.summ</th>
      <td><p>Summary statistic to use for the estimate of coefficients when
doing a Bayesian PGLMM (when <code>bayes = TRUE</code>). Options are: "mean",
"median", or "mode", referring to different characterizations of the central
tendency of the Bayesian posterior marginal distributions. Ignored if <code>bayes = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>calc.DIC</th>
      <td><p>Should the Deviance Information Criterion be calculated and returned,
when doing a Bayesian PGLMM? Ignored if <code>bayes = FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>prior</th>
      <td><p>Which type of default prior should be used by <code>pglmm</code>?
Only used if <code>bayes = TRUE</code>. There are currently four options:
"inla.default", which uses the default <code>INLA</code> priors; "pc.prior.auto", which uses a
complexity penalizing prior (as described in
<a href='https://arxiv.org/abs/1403.4630v3'>Simpson et al. (2017)</a>) designed to automatically
choose good parameters (only available for gaussian and binomial responses); "pc.prior", which
allows the user to set custom parameters on the "pc.prior" prior, using the <code>prior_alpha</code>
and <code>prior_mu</code> parameters (Run <code><a href='https://rdrr.io/pkg/INLA/man/doc.html'>INLA::inla.doc("pc.prec")</a></code> for details on these
parameters); and "uninformative", which sets a very uninformative prior
(nearly uniform) by using a very flat exponential distribution. The last option is generally
not recommended but may in some cases give estimates closer to the maximum likelihood estimates.
"pc.prior.auto" is only implemented for <code>family = "gaussian"</code> and <code>family = "binomial"</code>
currently.</p></td>
    </tr>
    <tr>
      <th>prior_alpha</th>
      <td><p>Only used if <code>bayes = TRUE</code> and <code>prior = "pc.prior"</code>, in
which case it sets the alpha parameter of <code>INLA</code>'s complexity penalizing prior for the
random effects.The prior is an exponential distribution where prob(sd &gt; mu) = alpha,
where sd is the standard deviation of the random effect.</p></td>
    </tr>
    <tr>
      <th>prior_mu</th>
      <td><p>Only used if <code>bayes = TRUE</code> and <code>prior = "pc.prior"</code>, in
which case it sets the mu parameter of <code>INLA</code>'s complexity penalizing prior for the
random effects.The prior is an exponential distribution where prob(sd &gt; mu) = alpha,
where sd is the standard deviation of the random effect.</p></td>
    </tr>
    <tr>
      <th>ML.init</th>
      <td><p>Only relevant if <code>bayes = TRUE</code>. Should maximum
likelihood estimates be calculated and used as initial values for
the bayesian model fit? Sometimes this can be helpful, but most of the
time it may not help; thus, we set the default to <code>FALSE</code>. Also, it
does not work with the zero-inflated families.</p></td>
    </tr>
    <tr>
      <th>s2.init</th>
      <td><p>An array of initial estimates of s2. If s2.init is not provided for
<code>family="gaussian"</code>, these are estimated using <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> assuming
no phylogenetic signal. If <code>s2.init</code> is not
provided for <code>family = "binomial"</code>, these are set to 0.25.</p></td>
    </tr>
    <tr>
      <th>B.init</th>
      <td><p>Initial estimates of \(B\), a matrix containing
regression coefficients in the model for the fixed effects. This
matrix must have <code>dim(B.init) = c(p + 1, 1)</code>, where <code>p</code> is the
number of predictor (independent) variables; the first element of
<code>B</code> corresponds to the intercept, and the remaining elements
correspond in order to the predictor (independent) variables in the
formula. If <code>B.init</code> is not provided, these are estimated
using <code><a href='https://rdrr.io/r/stats/lm.html'>lm</a></code> or <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code> assuming no phylogenetic signal.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object (list) of class <code>pglmm_compare</code> with the following elements:</p>
<dt>formula</dt><dd><p>the formula for fixed effects</p></dd>
<dt>formula_original</dt><dd><p>the formula for both fixed effects and random effects</p></dd>
<dt>data</dt><dd><p>the dataset</p></dd>
<dt>family</dt><dd><p>either <code>gaussian</code> or <code>binomial</code> or <code>poisson</code> depending on the model fit</p></dd>
<dt>B</dt><dd><p>estimates of the regression coefficients</p></dd>
<dt>B.se</dt><dd><p>approximate standard errors of the fixed effects regression coefficients.
This is set to NULL if <code>bayes = TRUE</code>.</p></dd>
<dt>B.ci</dt><dd><p>approximate bayesian credible interval of the fixed effects regression coefficients.
This is set to NULL if <code>bayes = FALSE</code></p></dd>
<dt>B.cov</dt><dd><p>approximate covariance matrix for the fixed effects regression coefficients</p></dd>
<dt>B.zscore</dt><dd><p>approximate Z scores for the fixed effects regression coefficients. This is set to NULL if <code>bayes = TRUE</code></p></dd>
<dt>B.pvalue</dt><dd><p>approximate tests for the fixed effects regression coefficients being different from zero. This is set to NULL if <code>bayes = TRUE</code></p></dd>
<dt>ss</dt><dd><p>random effects' standard deviations for the covariance matrix \(\sigma^2V\) for each random effect in order. For the linear mixed model, the residual variance is listed last</p></dd>
<dt>s2r</dt><dd><p>random effects variances for non-nested random effects</p></dd>
<dt>s2n</dt><dd><p>random effects variances for nested random effects</p></dd>
<dt>s2resid</dt><dd><p>for linear mixed models, the residual variance</p></dd>
<dt>s2r.ci</dt><dd><p>Bayesian credible interval for random effects variances for non-nested random effects.
This is set to NULL if <code>bayes = FALSE</code></p></dd>
<dt>s2n.ci</dt><dd><p>Bayesian credible interval for random effects variances for nested random effects.
This is set to NULL if <code>bayes = FALSE</code></p></dd>
<dt>s2resid.ci</dt><dd><p>Bayesian credible interval for linear mixed models, the residual variance.
This is set to NULL if <code>bayes = FALSE</code></p></dd>
<dt>logLik</dt><dd><p>for linear mixed models, the log-likelihood for either the restricted likelihood (<code>REML=TRUE</code>) or the overall likelihood (<code>REML=FALSE</code>). This is set to NULL for generalised linear mixed models. If <code>bayes = TRUE</code>, this is the marginal log-likelihood</p></dd>
<dt>AIC</dt><dd><p>for linear mixed models, the AIC for either the restricted likelihood (<code>REML=TRUE</code>) or the overall likelihood (<code>REML=FALSE</code>). This is set to NULL for generalised linear mixed models</p></dd>
<dt>BIC</dt><dd><p>for linear mixed models, the BIC for either the restricted likelihood (<code>REML=TRUE</code>) or the overall likelihood (<code>REML=FALSE</code>). This is set to NULL for generalised linear mixed models</p></dd>
<dt>DIC</dt><dd><p>for bayesian PGLMM, this is the Deviance Information Criterion metric of model fit. This is set to NULL if <code>bayes = FALSE</code>.</p></dd>
<dt>REML</dt><dd><p>whether or not REML is used (<code>TRUE</code> or <code>FALSE</code>).</p></dd>
<dt>bayes</dt><dd><p>whether or not a Bayesian model was fit.</p></dd>
<dt>marginal.summ</dt><dd><p>The specified summary statistic used to summarise the Bayesian marginal distributions.
Only present if <code>bayes = TRUE</code></p></dd>
<dt>s2.init</dt><dd><p>the user-provided initial estimates of <code>s2</code></p></dd>
<dt>B.init</dt><dd><p>the user-provided initial estimates of <code>B</code></p></dd>
<dt>Y</dt><dd><p>the response (dependent) variable returned in matrix form</p></dd>
<dt>X</dt><dd><p>the predictor (independent) variables returned in matrix form (including 1s in the first column)</p></dd>
<dt>H</dt><dd><p>the residuals. For linear mixed models, this does not account for random terms,
To get residuals after accounting for both fixed and random terms, use <code><a href='https://rdrr.io/r/stats/residuals.html'>residuals()</a></code>.
For the generalized linear mixed model, these are the predicted residuals in the
logit -1 space.</p></dd>
<dt>iV</dt><dd><p>the inverse of the covariance matrix. This is NULL if <code>bayes = TRUE</code>.</p></dd>
<dt>mu</dt><dd><p>predicted mean values for the generalized linear mixed model (i.e. similar to <code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted(merMod)</a></code>).
Set to NULL for linear mixed models, for which we can use <code><a href='https://rdrr.io/r/stats/fitted.values.html'>fitted()</a></code>.</p></dd>
<dt>Zt</dt><dd><p>the design matrix for random effects. This is set to NULL if <code>bayes = TRUE</code></p></dd>
<dt>St</dt><dd><p>diagonal matrix that maps the random effects variances onto the design matrix</p></dd>
<dt>convcode</dt><dd><p>the convergence code provided by <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>. This is set to NULL if <code>bayes = TRUE</code></p></dd>
<dt>niter</dt><dd><p>number of iterations performed by <code><a href='https://rdrr.io/r/stats/optim.html'>optim</a></code>. This is set to NULL if <code>bayes = TRUE</code></p></dd>
<dt>inla.model</dt><dd><p>Model object fit by underlying <code>inla</code> function. Only returned
if <code>bayes = TRUE</code></p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>pglmm_compare</code> in the package <code>phyr</code> is similar to <code>binaryPGLMM</code> in
the package <code>ape</code>, although it has much broader functionality, including
accepting more than just binary data, implementing Bayesian analyses, etc.</p>
<p>For non-Gaussian data, the function estimates parameters for the model</p>
<p>$$Pr(Y = 1) = \theta $$ $$\theta = inverse.link(b0 + b1 * x1 + b2 * x2 + \dots
+ \epsilon)$$ $$\epsilon ~ Gaussian(0, s2 * V) $$</p>
<p>where \(V\) is a covariance matrix derived from a phylogeny
(typically under the assumption of Brownian motion evolution). Although
mathematically there is no requirement for \(V\) to be ultrametric,
forcing \(V\) into ultrametric form can aide in the interpretation of the
model. This is especially true for binary data, because in regression for
binary dependent variables, only the off-diagonal elements (i.e., covariances)
of matrix \(V\) are biologically meaningful (see Ives &amp; Garland 2014).
The function converts a phylo tree object into a covariance matrix,
and further standardizes this matrix to have determinant = 1. This in effect
standardizes the interpretation of the scalar <code>s2</code>. Although mathematically
not required, it is a very good idea to standardize the predictor
(independent) variables to have mean 0 and variance 1. This will make the
function more robust and improve the interpretation of the regression
coefficients.</p>
<p>For Gaussian data, the function estimates parameters for the model</p>
<p>$$Y = b0 + b1 * x1 + b2 * x2 + \dots + \epsilon)$$
$$\epsilon ~ Gaussian(0, s2 * V + s2resid * I) $$</p>
<p>where \(s2resid * I\) gives the non-phylogenetic residual variance. Note that this
is equivalent to a model with Pagel's lambda transformation.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Ives, A. R. and Helmus, M. R. (2011) Generalized linear mixed
models for phylogenetic analyses of community structure. <em>Ecological
Monographs</em>, <b>81</b>, 511--525.</p>
<p>Ives, A. R. and Garland, T., Jr. (2014) Phylogenetic regression for binary
dependent variables. Pages 231--261 <em>in</em> L. Z. Garamszegi, editor.
<em>Modern Phylogenetic Comparative Methods and Their Application in
Evolutionary Biology</em>. Springer-Verlag, Berlin Heidelberg.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='pglmm.html'>pglmm</a></code>; package <span class="pkg">ape</span> and its function <code>binaryPGLMM</code>;
package <span class="pkg">phylolm</span> and its function <code>phyloglm</code>; package <span class="pkg">MCMCglmm</span></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Anthony R. Ives</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Illustration of `pglmm_compare` with simulated data</span>

<span class='co'># Generate random phylogeny</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ape-package.ird.fr/'>ape</a></span><span class='op'>)</span>

<span class='va'>n</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>phy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ape/man/compute.brlen.html'>compute.brlen</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/rtree.html'>rtree</a></span><span class='op'>(</span>n<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span>, method <span class='op'>=</span> <span class='st'>"Grafen"</span>, power <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'># Generate random data and standardize to have mean 0 and variance 1</span>
<span class='va'>X1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ape/man/rTraitCont.html'>rTraitCont</a></span><span class='op'>(</span><span class='va'>phy</span>, model <span class='op'>=</span> <span class='st'>"BM"</span>, sigma <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>X1</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='va'>X1</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>X1</span><span class='op'>)</span>

<span class='co'># Simulate binary Y</span>
<span class='va'>sim.dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/array.html'>array</a></span><span class='op'>(</span><span class='fl'>0</span>, dim <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span>, X1 <span class='op'>=</span> <span class='va'>X1</span>, row.names <span class='op'>=</span> <span class='va'>phy</span><span class='op'>$</span><span class='va'>tip.label</span><span class='op'>)</span>
<span class='va'>sim.dat</span><span class='op'>$</span><span class='va'>Y</span> <span class='op'>&lt;-</span> <span class='fu'>ape</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/binaryPGLMM.html'>binaryPGLMM.sim</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, phy <span class='op'>=</span> <span class='va'>phy</span>, data<span class='op'>=</span><span class='va'>sim.dat</span>, s2 <span class='op'>=</span> <span class='fl'>1</span>,
                             B <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.25</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>2</span>, ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>, 
                             nrep <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Y</span>

<span class='co'># Fit model</span>
<span class='fu'>pglmm_compare</span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span>, phy <span class='op'>=</span> <span class='va'>phy</span>, data <span class='op'>=</span> <span class='va'>sim.dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Generalized linear mixed model for binomial data fit by restricted maximum likelihood
#&gt; 
#&gt; Call:Y ~ X1
#&gt; &lt;environment: 0x7feaa7836b38&gt;
#&gt; 
#&gt; logLik    AIC    BIC 
#&gt;  -58.2  124.4  130.2 
#&gt; 
#&gt; Phylogenetic random effects variance (s2):
#&gt;    Variance Std.Dev
#&gt; s2        0       0
#&gt; 
#&gt; Fixed effects:
#&gt;               Value Std.Error Zscore  Pvalue    
#&gt; (Intercept) 0.93701   0.22875 4.0962 4.2e-05 ***
#&gt; X1          0.33993   0.17314 1.9634  0.0496 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># Compare with `binaryPGLMM`</span>
<span class='fu'>ape</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ape/man/binaryPGLMM.html'>binaryPGLMM</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, phy <span class='op'>=</span> <span class='va'>phy</span>, data <span class='op'>=</span> <span class='va'>sim.dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 
#&gt; Call:Y ~ X1
#&gt; &lt;environment: 0x7feaa7836b38&gt;
#&gt; 
#&gt; Random effect (phylogenetic signal s2):
#&gt;         s2     Pr
#&gt; 1 5.08e-10 0.4999
#&gt; 
#&gt; Fixed effects:
#&gt;               Value Std.Error Zscore  Pvalue    
#&gt; (Intercept) 0.93701   0.22875 4.0962 4.2e-05 ***
#&gt; X1          0.33993   0.17314 1.9634  0.0496 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; </div><div class='input'>
<span class='co'># Compare with `phyloglm`</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'>phylolm</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/phylolm/man/phyloglm.html'>phyloglm</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, phy <span class='op'>=</span> <span class='va'>phy</span>, data <span class='op'>=</span> <span class='va'>sim.dat</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: phyloglm failed to converge.</span></div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; phylolm::phyloglm(formula = Y ~ X1, data = sim.dat, phy = phy)
#&gt;        AIC     logLik Pen.logLik 
#&gt;     125.41     -59.71     -56.59 
#&gt; 
#&gt; Method: logistic_MPLE
#&gt; Mean tip height: 1
#&gt; Parameter estimate(s):
#&gt; alpha: 53.50916 
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate  StdErr z.value  p.value   
#&gt; (Intercept)  0.77292 0.24537  3.1500 0.001632 **
#&gt; X1           0.25037 0.18218  1.3743 0.169337   
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; Note: Wald-type p-values for coefficients, conditional on alpha=53.50916
#&gt; </div><div class='input'>
<span class='co'># Compare with `glm` that does not account for phylogeny</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, data <span class='op'>=</span> <span class='va'>sim.dat</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; Call:
#&gt; glm(formula = Y ~ X1, family = "binomial", data = sim.dat)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -1.9191  -1.3160   0.6911   0.8409   1.1588  
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)   0.9370     0.2287   4.096  4.2e-05 ***
#&gt; X1            0.3399     0.1731   1.963   0.0496 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 120.43  on 99  degrees of freedom
#&gt; Residual deviance: 116.40  on 98  degrees of freedom
#&gt; AIC: 120.4
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4
#&gt; </div><div class='input'>
<span class='co'># Compare with logistf() that does not account</span>
<span class='co'># for phylogeny but is less biased than glm()</span>
<span class='fu'>logistf</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/logistf/man/logistf.html'>logistf</a></span><span class='op'>(</span><span class='va'>Y</span> <span class='op'>~</span> <span class='va'>X1</span>, data <span class='op'>=</span> <span class='va'>sim.dat</span><span class='op'>)</span>
</div><div class='output co'>#&gt; logistf::logistf(formula = Y ~ X1, data = sim.dat)
#&gt; Model fitted by Penalized ML
#&gt; Confidence intervals and p-values by Profile Likelihood 
#&gt; 
#&gt; Coefficients:
#&gt; (Intercept)          X1 
#&gt;   0.9152256   0.3288414 
#&gt; 
#&gt; Likelihood ratio test=3.909395 on 1 df, p=0.04801687, n=100
#&gt; </div><div class='input'>
<span class='co'>## Fit model with bayes = TRUE</span>
<span class='co'># pglmm_compare(Y ~ X1, family = "binomial", phy = phy, data = sim.dat, </span>
<span class='co'>#               bayes = TRUE, calc.DIC = TRUE)</span>

<span class='co'># Compare with `MCMCglmm`</span>

<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ape/man/vcv.phylo.html'>vcv</a></span><span class='op'>(</span><span class='va'>phy</span><span class='op'>)</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='va'>V</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>
<span class='va'>detV</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/det.html'>determinant</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span><span class='op'>$</span><span class='va'>modulus</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>V</span> <span class='op'>&lt;-</span> <span class='va'>V</span><span class='op'>/</span><span class='va'>detV</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='va'>n</span><span class='op'>)</span>

<span class='va'>invV</span> <span class='op'>&lt;-</span> <span class='fu'>Matrix</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/Matrix/man/Matrix.html'>Matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>,sparse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>sim.dat</span><span class='op'>$</span><span class='va'>species</span> <span class='op'>&lt;-</span> <span class='va'>phy</span><span class='op'>$</span><span class='va'>tip.label</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>invV</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>sim.dat</span><span class='op'>$</span><span class='va'>species</span>

<span class='va'>nitt</span> <span class='op'>&lt;-</span> <span class='fl'>43000</span>
<span class='va'>thin</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>burnin</span> <span class='op'>&lt;-</span> <span class='fl'>3000</span>

<span class='va'>prior</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>R<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>V<span class='op'>=</span><span class='fl'>1</span>, fix<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>, G<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>G1<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>V<span class='op'>=</span><span class='fl'>1</span>, nu<span class='op'>=</span><span class='fl'>1000</span>, alpha.mu<span class='op'>=</span><span class='fl'>0</span>, alpha.V<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># commented out to save time</span>
<span class='co'># summary(MCMCglmm::MCMCglmm(Y ~ X1, random = ~species, ginvers = list(species = invV),</span>
<span class='co'>#     data = sim.dat, slice = TRUE, nitt = nitt, thin = thin, burnin = burnin,</span>
<span class='co'>#    family = "categorical", prior = prior, verbose = FALSE))</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Anthony Ives, Russell Dinnage, Lucas A. Nell, Matthew Helmus, Daijiang Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


