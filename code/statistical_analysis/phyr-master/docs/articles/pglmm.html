<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Usage of pglmm() â€¢ phyr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Usage of pglmm()">
<meta property="og:description" content="phyr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">phyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/benchmarks.html">Performance benchmark</a>
    </li>
    <li>
      <a href="../articles/pglmm.html">Usage of pglmm()</a>
    </li>
    <li>
      <a href="../articles/phyr_example_empirical.html">pglmm example with empirical data</a>
    </li>
    <li>
      <a href="../articles/plot-re.html">Plot random terms of communityPGLMM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/daijiang/phyr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pglmm_files/header-attrs-2.3/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Usage of pglmm()</h1>
                        <h4 class="author">Daijiang Li</h4>
            
            <h4 class="date">2020-12-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/daijiang/phyr/blob/master/vignettes/pglmm.Rmd"><code>vignettes/pglmm.Rmd</code></a></small>
      <div class="hidden name"><code>pglmm.Rmd</code></div>

    </div>

    
    
<p>The purpose of this vignette is <em>not</em> to provide detailed explanation of model set up and results. For this purpose, please read the documentation of <code><a href="../reference/pglmm.html">?phyr::pglmm</a></code> and the chapter 4 of <a href="https://leanpub.com/correlateddata">Ives 2018</a>. The purpose of this vignette is to show some cases that are not documented in details.</p>
<div id="fit-a-binomial-model-with-success-and-failures" class="section level1">
<h1 class="hasAnchor">
<a href="#fit-a-binomial-model-with-success-and-failures" class="anchor"></a>Fit a binomial model with success and failures</h1>
<p>To fit a binomial model to a data frame with columns of success and failures (say named as <code>yes</code> and <code>no</code>, respectively), use</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="../reference/pglmm.html">pglmm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">yes</span>, <span class="va">no</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">'binomial'</span><span class="op">)</span></pre></div>
</div>
<div id="prepare-random-terms-for-complex-models-that-cannot-be-set-up-with-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#prepare-random-terms-for-complex-models-that-cannot-be-set-up-with-formula" class="anchor"></a>Prepare random terms for complex models that cannot be set up with formula</h1>
<p>Sometimes, users may want to prepare their own list of random terms to fit phylogenetic generalized linear mixed models in more flexible ways. For example, users may want to add an extra random term on top of those specified by the model formula. For this, we can extract the list of random terms generated by the model formula using <code><a href="../reference/prep_dat_pglmm.html">prep_dat_pglmm()</a></code> and then append the one we want to add. See <code><a href="../reference/prep_dat_pglmm.html">?phyr::prep_dat_pglmm</a></code> for details about its arguments.</p>
</div>
<div id="other-functions-to-work-with-models-fitted-with-pglmm" class="section level1">
<h1 class="hasAnchor">
<a href="#other-functions-to-work-with-models-fitted-with-pglmm" class="anchor"></a>Other functions to work with models fitted with <code>pglmm()</code>
</h1>
<p>All models fitted with <code><a href="../reference/pglmm.html">pglmm()</a></code> have class of <code>communityPGLMM</code>. Here is a list of functions that can be used to these models.</p>
<ul>
<li>
<code><a href="../reference/pglmm_matrix_structure.html">pglmm_matrix_structure()</a></code>: produce the whole covariance matrix</li>
<li>
<code><a href="../reference/pglmm_plot_ranef.html">pglmm_plot_re()</a></code>: plot images of random term matrix, see vignettes <code>plot-re</code><br>
</li>
<li>
<code><a href="../reference/pglmm_predicted_values.html">pglmm_predicted_values()</a></code> or <code><a href="https://rdrr.io/r/stats/fitted.values.html">fitted()</a></code>: extract fitted values</li>
<li>
<code><a href="../reference/pglmm_profile_LRT.html">pglmm_profile_LRT()</a></code>: to test significance of random terms; only works with binomial models</li>
<li>
<code><a href="../reference/plot_data.html">plot_data()</a></code>: plot data used (and optionally predicted) by fitted model</li>
<li>
<code><a href="../reference/plot_bayes.html">plot_bayes()</a></code>: plot posterior distributions of random and fixed effects</li>
<li>
<code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>: summary of model fit</li>
<li>
<code><a href="https://rdrr.io/r/base/print.html">print()</a></code>: summary of model fit</li>
<li>
<code><a href="https://rdrr.io/r/stats/residuals.html">residuals()</a></code>: residuals values</li>
<li>
<code><a href="../reference/fixef.html">fixef()</a></code>: estimates of fixed effects</li>
<li>
<code><a href="../reference/ranef.html">ranef()</a></code>: estimates of random terms (variance and standard deviation)</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Anthony Ives, Russell Dinnage, Lucas A. Nell, Matthew Helmus, Daijiang Li.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
